<!doctype html>


<input type="hidden" name="_subject" value="Nuevo suscriptor - Ebook">
<div style="margin-top:12px">
<button type="submit" class="btn btn-primary">Recibir capítulo</button>
</div>
<div id="formMsg" class="note" aria-live="polite" style="margin-top:10px"></div>
</form>


<hr style="margin:14px 0">
<div>
<h4>Política de privacidad (resumen)</h4>
<p class="note">Recopilamos el email solo para enviar el extracto y comunicaciones relacionadas.</p>
</div>
</div>
</div>


<script>
// --- Dynamic header: show only other pages (not current) ---
(function buildNav(){
const nav = document.getElementById('mainNav');
const pages = [
{file:'index.html', label:'Inicio'},
{file:'libros.html', label:'Libros'},
{file:'reviews.html', label:'Reseñas'},
{file:'about.html', label:'Sobre mí'}
];
const current = (location.pathname.split('/').pop() || 'index.html').toLowerCase();
const left = document.createElement('div'); left.innerHTML = '<strong>Mi Sitio</strong>';
const right = document.createElement('nav');
pages.forEach(p => {
if(p.file === current) return; // skip current
const a = document.createElement('a'); a.href = p.file; a.textContent = p.label; a.style.marginLeft = '12px';
right.appendChild(a);
});
nav.appendChild(left); nav.appendChild(right);
})();


// modal logic
const modal = document.getElementById('modal');
const openModalBtn = document.getElementById('openModal');
const modalCloseBtn = document.getElementById('modalClose');
openModalBtn && openModalBtn.addEventListener('click', ()=> { modal.classList.add('open'); modal.setAttribute('aria-hidden','false'); });
modalCloseBtn && modalCloseBtn.addEventListener('click', ()=> { modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); });
modal && modal.addEventListener('click', e => { if(e.target === modal){ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); } });
document.addEventListener('keydown', e => { if(e.key === 'Escape' && modal.classList.contains('open')) { modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); } });


// Formspree with fetch feedback
const form = document.getElementById('leadForm');
const formMsg = document.getElementById('formMsg');
form && form.addEventListener('submit', async (ev) => {
ev.preventDefault(); formMsg.textContent = '';
const data = new FormData(form);
try{
const res = await fetch(form.action, {method:'POST', body: data, headers:{'Accept':'application/json'}});
if(res.ok){ formMsg.style.color='green'; formMsg.textContent='¡Gracias! Revisa tu correo.'; form.reset(); }
else{ const body = await res.json().catch(()=>null); formMsg.style.color='crimson'; formMsg.textContent = body?.error || 'Error al enviar.'; }
}catch(err){ formMsg.style.color='crimson'; formMsg.textContent='Error de red.'; }
});
</script>
</body>
</html>
